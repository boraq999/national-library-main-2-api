import{i as c,j as a,d as $e,o as Ce,B as l,R as j,e as n,a3 as w,a5 as Re,a6 as Me,a7 as Ae,a8 as te,a9 as D,q as y,G as s}from"./mui-MBCd4ndD.js";import{r,b as Oe}from"./vendor-gvDtyKy-.js";import{r as p,M as De,a as Ie}from"./index-Dr7ntMYS.js";import{e as g,B as We}from"./config-gz8lDFmP.js";import"./router-gA8worJh.js";var I={},Pe=c;Object.defineProperty(I,"__esModule",{value:!0});var ae=I.default=void 0,Ve=Pe(p()),Le=a;ae=I.default=(0,Ve.default)((0,Le.jsx)("path",{d:"M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M9 4h2v5l-1-.75L9 9zm9 16H6V4h1v9l3-2.25L13 13V4h5z"}),"BookOutlined");var W={},Te=c;Object.defineProperty(W,"__esModule",{value:!0});var re=W.default=void 0,He=Te(p()),Ee=a;re=W.default=(0,He.default)((0,Ee.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutline");var P={},qe=c;Object.defineProperty(P,"__esModule",{value:!0});var ie=P.default=void 0,Be=qe(p()),Ue=a;ie=P.default=(0,Be.default)((0,Ue.jsx)("path",{d:"M12 3 1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9zm6.82 6L12 12.72 5.18 9 12 5.28zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73z"}),"SchoolOutlined");var V={},Ge=c;Object.defineProperty(V,"__esModule",{value:!0});var le=V.default=void 0,Fe=Ge(p()),Ne=a;le=V.default=(0,Fe.default)((0,Ne.jsx)("path",{d:"M20 7h-4V5l-2-2h-4L8 5v2H4c-1.1 0-2 .9-2 2v5c0 .75.4 1.38 1 1.73V19c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2v-3.28c.59-.35 1-.99 1-1.72V9c0-1.1-.9-2-2-2M10 5h4v2h-4zM4 9h16v5h-5v-3H9v3H4zm9 6h-2v-2h2zm6 4H5v-3h4v1h6v-1h4z"}),"BusinessCenterOutlined");var L={},Je=c;Object.defineProperty(L,"__esModule",{value:!0});var ne=L.default=void 0,Ke=Je(p()),Qe=a;ne=L.default=(0,Ke.default)((0,Qe.jsx)("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zm0-12H5V6h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonthOutlined");var T={},Xe=c;Object.defineProperty(T,"__esModule",{value:!0});var se=T.default=void 0,Ye=Xe(p()),Ze=a;se=T.default=(0,Ye.default)((0,Ze.jsx)("path",{d:"M6.5 10h-2v7h2zm6 0h-2v7h2zm8.5 9H2v2h19zm-2.5-9h-2v7h2zm-7-6.74L16.71 6H6.29zm0-2.26L2 6v2h19V6z"}),"AccountBalanceOutlined");var H={},et=c;Object.defineProperty(H,"__esModule",{value:!0});var oe=H.default=void 0,tt=et(p()),at=a;oe=H.default=(0,tt.default)((0,at.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined");const ot=()=>{const i=$e(),[de,E]=r.useState(""),[ce,k]=r.useState([]),[pe,u]=r.useState(!1),[q,x]=r.useState(null),[ue,B]=r.useState(null),[xe,U]=r.useState(null),[he,G]=r.useState(null),[ge,fe]=r.useState([]),[me,ve]=r.useState([]),[be,je]=r.useState([]),[f,F]=r.useState(""),[m,N]=r.useState(null),[v,J]=r.useState(null),[S,K]=r.useState(null),[ye,Q]=r.useState(!1),[d,z]=r.useState(null),[b,_]=r.useState(1),[$,Se]=r.useState("title"),[_e,X]=r.useState(!1);Oe.useRef(null),r.useEffect(()=>{let t=!0;return(async()=>{u(!0),x(null);try{const o=await fetch(g.latestTheses);if(!o.ok)throw new Error("network");const h=await o.json();t&&(k(Array.isArray(h.data)?h.data:[]),z(h.pagination||null))}catch{t&&x("تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت أو المحاولة لاحقاً.")}finally{t&&u(!1)}})(),()=>{t=!1}},[]),r.useEffect(()=>{fetch(g.universities).then(t=>t.json()).then(t=>fe(Array.isArray(t)?t:[])),fetch(g.specializations).then(t=>t.json()).then(t=>ve(Array.isArray(t)?t:[])),fetch(g.degrees).then(t=>t.json()).then(t=>je(Array.isArray(t)?t:[]))},[]);const we=!!m||!!v||!!f.trim(),Y=()=>{setTimeout(()=>{const t=document.getElementById("results-section");t&&t.scrollIntoView({behavior:"smooth",block:"start"})},300)},C=async(t=1,e=!1)=>{const o=new URLSearchParams,h=e?ue:m,Z=e?xe:v,ee=e?he:S,M=e?de:f;h&&o.append("university_id",h.id),Z&&o.append("specialization_id",Z.id),ee&&o.append("degree_id",ee.id),M.trim()&&($==="title"?o.append("title",M.trim()):$==="author"&&o.append("author",M.trim())),o.append("page",t),u(!0),x(null);try{const A=await fetch(`${g.searchTheses}?${o.toString()}`);if(!A.ok)throw new Error("network");const O=await A.json();k(Array.isArray(O.data)?O.data:[]),z(O.pagination||null)}catch{x("تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت أو المحاولة لاحقاً.")}finally{u(!1)}},ke=async()=>{if(!f.trim()&&!m&&!v&&!S){Q(!0);return}Q(!1),E(f),B(m),U(v),G(S),_(1),X(!0),C(1)},ze=async()=>{F(""),N(null),J(null),K(null),E(""),B(null),U(null),G(null),_(1),X(!1),u(!0),x(null);try{const t=await fetch(g.latestTheses);if(!t.ok)throw new Error("network");const e=await t.json();k(Array.isArray(e.data)?e.data:[]),z(e.pagination||null)}catch{x("تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت أو المحاولة لاحقاً.")}finally{u(!1)}},R=ce;return a.jsxs(Ce,{maxWidth:!1,sx:{pt:15,px:{xs:2,md:10,lg:15},...i.bgGrid1},children:[a.jsx(De,{mainTitle:"المكتبة الإلكترونية"}),a.jsx(Ie,{mainText:"مكتبة إلكترونية شاملة تتيح الوصول للرسائل الأكاديمية السابقة"}),a.jsxs(l,{sx:{background:t=>t.palette.mode==="light"?j(t.palette.background.paper,.96):j(t.palette.background.paper,.91),borderRadius:3,p:3,my:4,boxShadow:i.shadows[3],display:"flex",flexDirection:"column",gap:2},children:[a.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2,flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",position:"relative"},children:[ye&&a.jsx(l,{sx:{width:"100%",display:"flex",justifyContent:"center",mb:1},children:a.jsx(n,{align:"center",color:"warning.main",sx:{fontWeight:700,fontSize:16,background:j(i.palette.warning.light,.1),border:`1px solid ${i.palette.warning.light}`,borderRadius:2,px:3,py:1},children:"الرجاء اختيار أحد الفلاتر على الأقل"})}),a.jsx(w,{label:"ابحث باسم الباحث أو الرسالة...",variant:"outlined",value:f,onChange:t=>F(t.target.value),sx:{minWidth:220,flex:1,direction:"rtl"},inputProps:{style:{direction:"rtl"}}}),a.jsxs(Re,{sx:{minWidth:140,mr:1},children:[a.jsx(Me,{id:"search-type-label",children:"نوع البحث"}),a.jsxs(Ae,{labelId:"search-type-label",id:"search-type-select",value:$,label:"نوع البحث",onChange:t=>Se(t.target.value),children:[a.jsx(te,{value:"title",children:"عنوان الرسالة"}),a.jsx(te,{value:"author",children:"اسم الباحث"})]})]})]}),a.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2,flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between"},children:[a.jsx(D,{options:ge,getOptionLabel:t=>t.name||"",value:m,onChange:(t,e)=>N(e),renderInput:t=>a.jsx(w,{...t,label:"الجامعة",variant:"outlined"}),sx:{minWidth:180,flex:1},isOptionEqualToValue:(t,e)=>t?.id===e?.id}),a.jsx(D,{options:me,getOptionLabel:t=>t.name||"",value:v,onChange:(t,e)=>J(e),renderInput:t=>a.jsx(w,{...t,label:"التخصص",variant:"outlined"}),sx:{minWidth:180,flex:1},isOptionEqualToValue:(t,e)=>t?.id===e?.id}),a.jsx(D,{options:be,getOptionLabel:t=>t.name||"",value:S,onChange:(t,e)=>K(e),renderInput:t=>a.jsx(w,{...t,label:"الدرجة العلمية",variant:"outlined"}),sx:{minWidth:180,flex:1},isOptionEqualToValue:(t,e)=>t?.id===e?.id})]}),a.jsxs(l,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:{xs:"center",sm:"flex-end"},width:"100%"},children:[a.jsx(y,{variant:"contained","aria-label":"بحث",sx:{minWidth:120,fontWeight:700,height:56,alignSelf:"center",color:"white",backgroundColor:i.palette.bg3.main,"&:hover":{background:i.palette.bg3.sec}},onClick:ke,disabled:!we,children:"بحث"}),a.jsx(y,{variant:"outlined",color:"secondary","aria-label":"مسح الفلاتر",sx:{minWidth:120,fontWeight:700,height:56,alignSelf:"center"},onClick:ze,children:"مسح الفلاتر"})]})]}),a.jsx(s,{container:!0,spacing:3,id:"results-section",children:pe?a.jsx(s,{item:!0,xs:12,children:a.jsx(n,{align:"center",color:"text.secondary",children:"جاري تحميل البيانات..."})}):q?a.jsx(s,{item:!0,xs:12,children:a.jsxs(l,{sx:{p:3,textAlign:"center",color:"error.main",background:t=>t.palette.mode==="light"?j(t.palette.error.main,.1):j(t.palette.error.dark,.2),borderRadius:2,border:"1px solid",borderColor:"error.main",fontWeight:700},children:[a.jsx(n,{align:"center",color:"error.main",sx:{fontWeight:700,fontSize:18},children:q}),a.jsx(n,{align:"center",color:"text.secondary",sx:{mt:1,fontSize:15},children:"تأكد من اتصالك بالإنترنت أو أعد المحاولة لاحقاً."})]})}):R.length===0?a.jsx(s,{item:!0,xs:12,children:a.jsx(n,{align:"center",color:"text.secondary",children:"لا توجد نتائج مطابقة."})}):a.jsxs(a.Fragment,{children:[_e&&a.jsx(s,{item:!0,xs:12,children:a.jsxs(n,{variant:"subtitle1",sx:{mb:2,textAlign:"right",fontWeight:600,color:i.palette.primary.main},children:["تم العثور على",a.jsx("span",{style:{backgroundColor:"#33d13df9",padding:"4px 7px",borderRadius:"5px",border:"1px solid yellow",color:"#fff"},children:d?d.total:R.length})," نتيجة",d&&d.last_page>1&&a.jsxs("span",{style:{marginRight:"10px",fontSize:"14px",color:"#666"},children:["(الصفحة ",d.current_page," من ",d.last_page,")"]})]})}),R.map(t=>a.jsx(s,{item:!0,xs:12,md:6,children:a.jsxs(l,{sx:{...i.card2,p:2.5,mb:2,direction:"rtl",textAlign:"right",display:"flex",flexDirection:"column",gap:2,alignItems:"flex-end",minHeight:180},children:[a.jsxs(n,{variant:"h6",sx:{fontWeight:700,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,mb:1,textAlign:"right",fontSize:{xs:16,md:18},display:"flex",alignItems:"center",gap:1,direction:"rtl",textAlign:"end"},children:[a.jsx(ae,{sx:{ml:1,color:"primary.main"}}),t.title]}),a.jsx(l,{sx:{borderTop:"1px solid",borderColor:e=>e.palette.mode==="light"?e.palette.primary.light:e.palette.divider,width:"100%",mb:2}}),a.jsxs(s,{container:!0,spacing:2,alignItems:"center",direction:"row-reverse",children:[a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,flexDirection:"row-reverse",background:e=>e.palette.mode==="light"?e.palette.background.default:e.palette.background.paper,borderRadius:2,p:1,border:e=>e.palette.mode==="light"?`1px solid ${e.palette.divider}`:`1px solid ${e.palette.divider}`,fontSize:15,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,direction:"rtl",textAlign:"right"},children:[a.jsx(re,{sx:{color:"primary.main",ml:1}}),a.jsx(n,{sx:{fontWeight:500},children:t.author?.name||""})]})}),a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,flexDirection:"row-reverse",background:e=>e.palette.mode==="light"?e.palette.background.default:e.palette.background.paper,borderRadius:2,p:1,border:e=>e.palette.mode==="light"?`1px solid ${e.palette.divider}`:`1px solid ${e.palette.divider}`,fontSize:15,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,direction:"rtl",textAlign:"right"},children:[a.jsx(se,{sx:{color:"primary.main",ml:1}}),a.jsx(n,{sx:{fontWeight:500},children:t.university?.name||""})]})}),a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,flexDirection:"row-reverse",background:e=>e.palette.mode==="light"?e.palette.background.default:e.palette.background.paper,borderRadius:2,p:1,border:e=>e.palette.mode==="light"?`1px solid ${e.palette.divider}`:`1px solid ${e.palette.divider}`,fontSize:15,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,direction:"rtl",textAlign:"right"},children:[a.jsx(ne,{sx:{color:"primary.main",ml:1}}),a.jsx(n,{sx:{fontWeight:500},children:t.year?t.year.split("/").pop():""})]})}),a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,flexDirection:"row-reverse",background:e=>e.palette.mode==="light"?e.palette.background.default:e.palette.background.paper,borderRadius:2,p:1,border:e=>e.palette.mode==="light"?`1px solid ${e.palette.divider}`:`1px solid ${e.palette.divider}`,fontSize:15,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,direction:"rtl",textAlign:"right"},children:[a.jsx(ie,{sx:{color:"primary.main",ml:1}}),a.jsx(n,{sx:{fontWeight:500},children:t.degree?.name||""})]})}),a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5,flexDirection:"row-reverse",background:e=>e.palette.mode==="light"?e.palette.background.default:e.palette.background.paper,borderRadius:2,p:1,border:e=>e.palette.mode==="light"?`1px solid ${e.palette.divider}`:`1px solid ${e.palette.divider}`,fontSize:15,color:e=>e.palette.mode==="light"?e.palette.primary.dark:e.palette.common.white,direction:"rtl",textAlign:"right"},children:[a.jsx(le,{sx:{color:"primary.main",ml:1}}),a.jsx(n,{sx:{fontWeight:500},children:t.specialization?.name||""})]})}),a.jsx(s,{item:!0,xs:12,sm:6,children:a.jsxs(y,{variant:"contained","aria-label":"اطلع على الرسالة",sx:{background:i.palette.bg3.main,fontSize:13,borderRadius:2,minWidth:100,color:"white",mt:1,px:3,py:1.2,boxShadow:"none",direction:"rtl",textAlign:"right",display:"flex",flexDirection:"row-reverse",alignItems:"center","&:hover":{background:i.palette.bg3.sec}},href:t.pdf_path?`${We}${t.pdf_path.replace("/home/c-library-alalem/htdocs/alalem.c-library.org/storage/app/public","/storage")}`:void 0,target:"_blank",rel:"noopener noreferrer",disabled:!t.pdf_path,children:[a.jsx(oe,{sx:{mr:2}}),"اطلع على الرسالة"]})})]})]})},t.id))]})}),d&&d.last_page>1&&a.jsxs(l,{sx:{display:"flex",justifyContent:"center",mt:4,mb:2},children:[a.jsx(y,{variant:"contained","aria-label":"السابق",disabled:b===1,onClick:()=>{const t=b-1;_(t),C(t,!0),Y()},sx:{mx:1,backgroundColor:i.palette.bg3.main,color:"white","&:hover":{backgroundColor:i.palette.bg3.sec},"&:disabled":{backgroundColor:i.palette.grey[300],color:i.palette.grey[500]}},children:"السابق"}),a.jsxs(n,{sx:{mx:2,alignSelf:"center",fontWeight:600},children:[b," من ",d.last_page]}),a.jsx(y,{variant:"contained","aria-label":"التالي",disabled:b===d.last_page,onClick:()=>{const t=b+1;_(t),C(t,!0),Y()},sx:{mx:1,backgroundColor:i.palette.bg3.main,color:"white","&:hover":{backgroundColor:i.palette.bg3.sec},"&:disabled":{backgroundColor:i.palette.grey[300],color:i.palette.grey[500]}},children:"التالي"})]})]})};export{ot as default};
